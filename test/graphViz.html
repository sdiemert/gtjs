<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Some Graphs</title>

    <script src="http://code.jquery.com/jquery-1.11.3.min.js"></script>
    <script src="require.js"></script>
    <link rel='stylesheet' href="vis.min.css"/>

    <style type="text/css">
        .viz-container {
            width: 600px;
            height: 400px;
            border: 1px solid lightgray;
        }
    </style>

</head>
<body>


    <h1>Graph Test!</h1>

    <p id="output"></p>

    <div id="viz-1" class="viz-container"></div> <br>
    <div id="viz-2" class="viz-container"></div> <br>
    <div id="viz-3" class="viz-container"></div> <br>



    <script>

        requirejs(['../bin/GraphFactory', '../bin/VizJsAdaptor', 'vis.min.js', '../bin/Rule'], function(Factory, Adaptor, vis, Rule){

            function showGraph(id, toShow){

                var A = new Adaptor.VizJsAdaptor();

                var a = A.adapt(toShow);

                var nodes = new vis.DataSet(a.nodes);
                var edges = new vis.DataSet(a.edges);
                var container = document.getElementById(id);
                var data = {
                    nodes : nodes,
                    edges : edges
                };
                var net = new vis.Network(container, data, {});

            }

            /*
            var adj2 = {

                0: [1],
                1: [2],
                2: [3],
                3: [4],
                4: [0]

            };
            */

            var adj2 = {

                0: []

            };

            var adj = {

                0: []

            };

            var gf = new Factory.GraphFactory();
            var H = gf.newGraphFromAdjList(adj2);
            var G = gf.newGraphFromAdjList(adj);

            showGraph("viz-1", H);
            showGraph("viz-2", G);

            //Deletion rule
            var r1 = new Rule.Rule(G, function(host, ids){

                $('#output').text(ids);
                host.removeNode(ids[ids.length - 1]);
                return host;

            });

            //Addition Rule
            var r2 = new Rule.Rule(G, function(host, ids){

                $('#output').text(ids);

                var x = host.addNode();

                for(var i = 0; i < ids.length; i++){

                    host.addEdgeByNumber(x, ids[i], {}, 0);

                }

                return host;

            });

            var addLeaf = new Rule.Rule(G, function(host, ids){

                var x = host.addNode();
                host.addEdgeByNumber(ids[0], x, {}, 1);
                return host;

            });

            var i = 0;

            var N = addLeaf.tryRule(H);

            while(i < 100 && N){
                N = addLeaf.tryRule(H);
                console.log(N);
                console.log(i);
                i++;
            }

            showGraph("viz-3", H);


        });

    </script>
</body>
</html>